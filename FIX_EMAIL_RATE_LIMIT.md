# 「email rate limit exceeded」エラーの解決方法

## エラーの原因

「email rate limit exceeded」というエラーは、Supabaseのメール送信レート制限に達したことを示しています。

**原因：**
- 短時間に多くのメール送信リクエストを送った
- Supabaseの無料プランでは、1時間あたりのメール送信数に制限がある
- 開発中に何度も会員登録を試した場合、この制限に達することがある

## 解決方法

### 方法1: メール確認を無効にする（開発環境・推奨）

開発環境では、メール確認を無効にすることで、この問題を回避できます。

#### ステップ1: Supabaseの認証設定を開く

1. Supabaseのダッシュボードにログイン
2. 左側のメニューから「**Authentication**」をクリック
3. 次に「**Providers**」または「**Settings**」をクリック
   - UIによっては「Providers」タブが表示される場合があります
   - または、上部のタブで「Settings」を選択

#### ステップ2: メール確認を無効にする

**方法A: 「Providers」タブから設定する場合**

1. 「**Email**」プロバイダーを探す
2. 「Email」をクリックして設定を開く
3. 「**Confirm email**」または「**Enable email confirmations**」のトグルスイッチを探す
4. トグルスイッチを**OFF**にする（左側に移動）
5. ページ下部の「**Save**」ボタンをクリック

**方法B: 「Settings」タブから設定する場合**

1. 「**Email Auth**」セクションを探す
2. 「**Confirm email**」または「**Enable email confirmations**」のトグルスイッチを探す
3. トグルスイッチを**OFF**にする（左側に移動）
4. 設定を保存（自動的に保存される場合が多い）

**方法C: 見つからない場合の代替方法**

もし「Confirm email」の設定が見つからない場合：

1. 「**Authentication**」→「**Policies**」または「**URL Configuration**」を確認
2. または、左側のメニューから「**Settings**」→「**Auth**」を確認
3. 「**Site URL**」の下に「**Redirect URLs**」などの設定がある場合、その近くにメール確認の設定がある可能性があります

**それでも見つからない場合：**

SupabaseのUIが更新されている可能性があります。以下の方法を試してください：

1. **検索機能を使用**
   - ページ内で `Ctrl + F`（Windows）または `Cmd + F`（Mac）を押す
   - 「confirm」や「email」と検索して、該当する設定を探す

2. **すべてのタブを確認**
   - 「Authentication」配下のすべてのタブ（Providers、Settings、Policies、URL Configurationなど）を確認

3. **Supabaseのドキュメントを参照**
   - https://supabase.com/docs/guides/auth/auth-email
   - 最新のUIに合わせた手順が記載されている可能性があります

**これで、メール確認なしで会員登録できるようになります！**

### 方法2: しばらく待ってから再試行する

メール確認を有効にしたまま使用する場合：

1. **1時間待つ**（レート制限がリセットされるまで）
2. その後、再度会員登録を試す

**注意：** この方法は一時的な解決策です。開発中に何度も試すと、再び制限に達する可能性があります。

### 方法3: 別のメールアドレスを使用する

同じメールアドレスで何度も登録を試している場合：

1. 別のメールアドレスを使用して会員登録を試す
2. または、既存のアカウントでログインする

## 確認方法

### メール確認が無効になっているか確認

1. Supabaseのダッシュボードで「Authentication」→「Settings」を開く
2. 「Confirm email」が**OFF**になっていることを確認

### 動作確認

1. ブラウザで `http://localhost:3000` を開く
2. 会員登録を試す
3. エラーが出ずに登録できることを確認
4. メール確認なしでログインできることを確認

## 本番環境での注意

**重要：** 本番環境（実際にユーザーが使用する環境）では、メール確認を**ON**にすることを推奨します。

**理由：**
- セキュリティの向上
- 不正なアカウント作成の防止
- ユーザーのメールアドレスの確認

**本番環境での設定方法：**
1. Supabaseのダッシュボードで「Authentication」→「Settings」を開く
2. 「Confirm email」を**ON**にする
3. 必要に応じて、カスタムメールテンプレートを設定

## その他の設定オプション

### メール送信の制限を確認

Supabaseのダッシュボードで：
1. 「Settings」→「API」を開く
2. メール送信の制限情報を確認

### カスタムメールテンプレート

本番環境では、カスタムメールテンプレートを設定することもできます：

1. 「Authentication」→「Email Templates」を開く
2. 確認メール、パスワードリセットメールなどのテンプレートを編集

## 参考

- Supabase公式ドキュメント: https://supabase.com/docs/guides/auth/auth-email
- `SETUP_GUIDE_AUTH.md` の「ステップ4-3: 認証設定を確認」を参照
